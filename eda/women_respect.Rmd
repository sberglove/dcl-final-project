---
title: "Respecting women"
author: "Sara Berg-Love "
date: "2020-03-14"
output: 
  github_document:
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r message=FALSE, warning=FALSE}
# Libraries
library(tidyverse)

# Parameters
file_data <- here::here("data/women_respect.rds")

#===============================================================================

women_respect_all <- read_rds(file_data)
```


The Gallup World Poll started in 2005 and surveys about 1,000 people per year in more than 160 countries worldwide [1]. The interview questions are about global issues as well as region-specific issues. The global questions are asked in the same way in order to provide comparisons across countries. This data focuses on if women are respected or not [2].

## Summary

```{r summary}
women_respect_all %>% 
  summary()

women_respect_all %>% 
  summarize_all(~ sum(is.na(.))) %>% 
  pivot_longer(cols = (-country), names_to = "field", values_to = "num_na") %>% 
  select(-country) %>% 
  mutate(perct_na = num_na / nrow(women_respect_all) * 100) %>% 
  arrange(perct_na)
```

There are a lot of data points covering the years 2005 to 2017, which seems good. The `region`, `region_2`, `year`, `gender`, `age`, and `marital_status` variables are all variables that would be interesting to see if they effect the proportion of if women are respected or not. About 39% of the `female_respected_1` variable responses are `NA`s, which is a little concerning, but it is the least percentage by far of all of the possible variables measuring female respect. Overall it still provides enough data to analyze.

### Available country and regions data

```{r respect_countries_regions}
women_respect_all %>% 
  group_by(country) %>% 
  distinct(country)

women_respect_all %>% 
  distinct(region) %>% 
  arrange(region)

women_respect_all %>% 
  distinct(region_2) %>% 
  arrange(region_2)
```

There is data for 164 different countries. 

The Commonwealth of Independent States is a group of post-Soviet republics in Eurasia. The 9 member states are:

 * Armenia
 * Azerbaijan
 * Belarus
 * Kazakhstan
 * Kyrgyzstan
 * Moldova
 * Russia
 * Tajikistan
 * Uzbekistan
 * Turkmenistan (associate state)
 
Latin America and the Caribbean region includes South America. 
 
### "Don't know" and "refused" values in data
 
```{r respect_DK_Refused}
women_respect <- 
  women_respect_all %>% 
  select(
    country, 
    weight, 
    region, 
    region_2, 
    gender, 
    year, 
    age, 
    marital_status, 
    women_respected = women_respected_1
  ) %>% 
  drop_na(women_respected)

women_respect %>% 
  count(
    women_respected, country, gender, year, wt = weight, name = "prop_respect"
  ) %>% 
  mutate(prop_respect = prop_respect / sum(prop_respect)) %>% 
  filter(women_respected %in% c("(DK)", "(Refused)")) %>% 
  arrange(desc(prop_respect))
```
 
The maximum percentage of "Don't Know" or "Refused to answer" is 0.014%, so they are fairly insignificant. Then we can filter for only "Yes" responses to if women are respected and assume the rest is "No". 
 
```{r filter_DK_refused}
women_respect <-
  women_respect %>%
  filter(!women_respected %in% c("(DK)", "(Refused)"))
```
 
## 1D analysis
 
### Available years of data

```{r respect_years}
women_respect %>% 
  ggplot(aes(year)) +
  geom_bar() +
  scale_x_continuous(breaks = scales::breaks_width(1)) +
  labs(
    title = "The most data is from 2011, 2012, and 2015 - 2017",
    x = NULL,
    y = "Number of countries",
    caption = "Source: Gallup World Poll"
  )
```

```{r respect_countries_data}
women_respect %>% 
  distinct(country, year) %>% 
  count(country) %>% 
  ggplot(aes(n)) +
  geom_bar() +
  scale_x_continuous(breaks = scales::breaks_width(1)) +
  labs(
    title = "Most countries have 7 years of data",
    x = "Number of data points",
    y = "Number of countries",
    caption = "Source: Gallup World Poll"
  )
```

There is at least 5 years of data for 132 of the 164 countries (80%).

### Distribution of age
```{r respect_ages}
women_respect %>% 
  filter(year == 2017) %>% 
  ggplot(aes(age, weight = weight, fill = women_respected)) +
  geom_histogram(binwidth = 3, na.rm = TRUE, position = "dodge") +
  scale_x_continuous(breaks = scales::breaks_width(10)) +
  theme(legend.position = "bottom") +
  labs(
    title = "The poll represents more younger peoples' views",
    subtitle = 
      "Higher percentages of younger people believe women aren't respected in 2017",
    x = "Age",
    y = "Number of people",
    fill = "Are women respected\nin your country?",
    caption = "Source: Gallup World Poll"
  )
```

### Distribution of gender
```{r respect_gender}
women_respect %>% 
  filter(year == 2017) %>% 
  ggplot(aes(gender, weight = weight, fill = women_respected)) +
  geom_bar() +
  labs(
    title = "More men than women think women are respected",
    subtitle = "More men are represented in the poll in 2017",
    x = "Age",
    y = "Number of people",
    fill = "Are women respected\nin your country?",
    caption = "Source: Gallup World Poll"
  )
```

### Distribution of marital status
```{r respect_marital_status}
women_respect %>% 
  filter(year == 2017, !marital_status %in% c("(DK)", "(Refused)")) %>% 
  ggplot(aes(marital_status, weight = weight, fill = women_respected)) +
  geom_bar(position = "dodge") +
  coord_flip() +
  labs(
    title = 
      "Single, separated, or people in domestic partnerships are\nmore likely to think women are not respected",
    subtitle = "Most people surveyed in 2017 are married",
    x = "Marital status",
    y = "Number of people",
        fill = "Are women respected\nin your country?",
    caption = "Source: Gallup World Poll"
  )
```


## Breakdown by years, genders, and regions

### By year, worldwide median respect of women

Breaking up the data into proportions of overall respect and proportions of respect by gender.

```{r respect_props}
women_respect_prop_gender <- 
  women_respect_all %>% 
  drop_na(women_respected_1, gender) %>% 
  count(
    country, 
    year, 
    region,
    region_2,
    gender,
    women_respected_1, 
    wt = weight, 
    name = "prop_respect"
  ) %>% 
  group_by(country, year, gender) %>% 
  mutate(prop_respect = prop_respect / sum(prop_respect)) %>%
  ungroup() %>% 
  filter(women_respected_1 == "Yes") %>% 
  pivot_wider(names_from = gender, values_from = prop_respect) %>% 
  select(-women_respected_1)

women_respect_props <- 
  women_respect_all %>% 
  drop_na(women_respected_1) %>% 
  count(
    country, 
    year, 
    region,
    region_2,
    women_respected_1,
    wt = weight, 
    name = "prop_respect"
  ) %>% 
  group_by(country, year) %>% 
  mutate(All = prop_respect / sum(prop_respect)) %>%
  ungroup() %>% 
  filter(women_respected_1 == "Yes") %>% 
  left_join(
    women_respect_prop_gender, by = c("country", "year", "region", "region_2")
  ) %>% 
  pivot_longer(
    cols = c(All, Female, Male), 
    names_to = "prop_type", values_to = "prop"
  ) %>% 
  select(-women_respected_1)
```

```{r respect_year_median}
women_respect_props %>% 
  group_by(year) %>% 
  filter(prop_type == "All") %>% 
  ggplot(aes(year, prop)) +
  geom_boxplot(aes(group = year), varwidth = TRUE) +
  scale_x_continuous(breaks = scales::breaks_width(1)) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
  labs(
    title = "On average 60 - 70% of men and women think women are respected",
    x = NULL,
    y = "Percentage believing women are respected",
    caption = "Source: Gallup World Poll"
  )

women_respect_props %>% 
  filter(prop_type != "All") %>% 
  ggplot(aes(factor(1), prop, color = prop_type)) +
  geom_boxplot(varwidth = TRUE) +
  facet_grid(cols = vars(year)) +
  scale_x_discrete(breaks = NULL) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
  scale_color_manual(values = c("Female" = "deep pink", "Male" = "blue")) +
  theme(legend.position = "bottom") +
  labs(
    title = "Men believe women are more respected than women do",
    x = NULL,
    y = "Percentage believing women are respected",
    color = NULL,
    caption = "Source: Gallup World Poll"
  )
```

Opinions on whether women are respected vary significantly by gender. with men thinking that women are more respected than women do.

### By country, are women respected in your country?

```{r respect_function_plot, out.width = "100%"} 
plot_country <- function(single_country) {
  women_respect_props %>% 
    filter(country == single_country) %>% 
    ggplot(aes(year, prop, color = prop_type)) +
    geom_point() +
    geom_line() +
    scale_x_continuous(breaks = scales::breaks_width(2)) +
    scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
    scale_color_manual(
      values = c("All" = "black", "Female" = "deep pink", "Male" = "blue")
    ) +
    theme(legend.position = "bottom") +
    labs(
      title = str_c("Are women respected in ", single_country, "?"), 
      x = "Year", 
      y = 'Percentage responding "Yes"',
      color = "Gender",
      caption = "Source: Gallup World Poll"
    )
}
```

```{r respect_single_country_plot}
plot_country("United States")
plot_country("Saudi Arabia")
plot_country("United Arab Emirates")
plot_country("Brazil")
```

Some interesting country trends to note:

* In the United States, women felt significantly less respected in 2016 (when Trump was elected), but men thought women were more respected (since Hillary Clinton was running for president).
* Perceived female respect is higher in Middle Eastern countries such as Saudi Arabia and the United Arab Emirates than in South American countries such as Brazil.
  + This could be due to experiences within cultural norms.
* In countries in general, women always feel less respected than men think they are. 

### By region, are women respected in your country?

```{r respect_region_plot_small, out.width="100%", fig.height=5}
women_respect_props %>% 
  group_by(region_2, year, prop_type) %>% 
  mutate(prop = mean(prop)) %>% 
  ungroup() %>% 
  ggplot(aes(year, prop, color = prop_type)) +
  geom_line() +
  facet_wrap(vars(region_2), ncol = 3) +
  scale_x_continuous(breaks = scales::breaks_width(2)) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
  scale_color_manual(
    values = c("All" = "black", "Female" = "deep pink", "Male" = "blue")
  ) +
  theme(legend.position = "bottom") +
  labs(
    title = "Are women respected in your country?", 
    x = NULL, 
    y = 'Percentage responding "Yes"',
    color = "Gender",
    caption = "Source: Gallup World Poll"
  )
```

```{r respect_region_plot_large, out.width="100%", fig.height=7}
women_respect_props %>% 
  group_by(region, year, prop_type) %>% 
  mutate(prop = mean(prop)) %>% 
  ungroup() %>% 
  ggplot(aes(year, prop, color = prop_type)) +
  geom_line() +
  facet_wrap(vars(region), ncol = 3) +
  scale_x_continuous(breaks = scales::breaks_width(2)) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
  scale_color_manual(
    values = c("All" = "black", "Female" = "deep pink", "Male" = "blue")
    ) +
  theme(legend.position = "bottom") +
  labs(
    title = "Are women respected in your country?", 
    x = NULL, 
    y = 'Percentage responding "Yes"',
    color = "Gender",
    caption = "Source: Gallup World Poll"
  )
```

Opinions across genders are most clearly aligned in Southeast Asia and significantly the lowest in Latin America and the Caribbean.

```{r respect_region_agg, out.width="100%"}
women_respect_props %>% 
  filter(prop_type == "All") %>% 
  group_by(region, year) %>% 
  summarize(prop = mean(prop)) %>% 
  ungroup() %>% 
  ggplot(aes(year, prop, color = region)) +
  geom_line() +
  ggrepel::geom_text_repel(
    data = . %>% filter(year == 2017), 
    aes(label = region), 
    size = 2, 
    nudge_x = 1, 
    point.padding = 0.25
  ) +
  scale_x_continuous(breaks = seq(2009, 2017, 2), limits = c(2009, 2018)) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
  theme(legend.position = "none") +
  labs(
    title = "Are women respected in your country?", 
    x = NULL, 
    y = 'Percentage responding "Yes"',
    color = "Gender",
    caption = "Source: Gallup World Poll"
  )
```

In general, perceived female respect varies greatly by region. The Latin America and Caribbean has the lowest respect percentages by far, around 35% in 2017, with Sub-Saharan being a little less than double at 65% in 2017. Southeast Asia and the Australia-New Zealand regions have the highest percentages of female respect, around 85%. Overall, female respect worldwide has been declining since at least 2015. 

## References

[1] [Methodology: How does the Gallup World Poll Work?](https://www.gallup.com/178667/gallup-world-poll-work.aspx)

[2] Gallup World Poll. [“Do you believe that women in this country are treated with respect and dignity, or not?”](https://wpr.gallup.com/home.aspx?ref=logo)
